# 💰 智能基金实时估值助手 (AI版)

这是一个基于 Python 的命令行工具，用于实时查询基金估值，并利用**阿里云百炼 (通义千问)** 大模型进行智能市场分析和持仓建议。

## ✨ 主要功能

1.  **双引擎实时估值**：
    *   同时接入 **天天基金** 和 **新浪财经** 实时接口。
    *   自动计算两个数据源的平均值，提高盘中估值的准确性。
2.  **持仓盈亏自动计算**：
    *   根据持仓金额实时计算当日预估盈亏。
    *   支持查看总持仓金额和当日总盈亏。
3.  **🧠 AI 智能投资顾问**：
    *   集成阿里云千问大模型 (`qwen-plus`)。
    *   根据今日市场涨跌、您的**仓位使用率**和**当前持有收益率 (HPR)**，生成个性化的操作建议（补仓、止盈或观望）。
    *   自动分析今日市场板块轮动情况。
4.  **CSV 批量管理**：
    *   通过 CSV 文件管理基金列表，支持设置目标总仓位，更科学地控制风险。

## 🛠️ 环境依赖

*   Python 3.8+
*   阿里云 DashScope SDK

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install dashscope
```

### 2. 配置 API Key

本项目使用阿里云百炼大模型进行分析，你需要申请一个 API Key。
1.  访问 [阿里云百炼控制台](https://bailian.console.aliyun.com/)。
2.  开通模型服务并创建一个 API Key。
3.  打开 `fund_valuation.py` 文件，找到以下代码并替换你的 Key：

```python
# fund_valuation.py
ALIYUN_API_KEY = "sk-xxxxxxxxxxxxxxxxxxxxxxxx"  # 替换这里
```

### 3. 配置基金持仓文件 (`funds.csv`)

在项目根目录下创建一个名为 `funds.csv` 的文件（初次运行程序会自动生成示例文件）。

格式如下：
```csv
code,amount,total_position,HPR
019172,1968,3000,-0.08
024575,4063,10000,-0.88
001186,5000,10000,5.2
```

**列说明：**
*   `code`: 基金代码 (6位数字)
*   `amount`: 当前持有金额 (元)
*   `total_position`: *[可选]* 计划投入该基金的总金额 (用于计算仓位使用率)
*   `HPR`: *[可选]* 当前持有收益率 (百分比，例如 `-0.88` 代表亏损 0.88%)

### 4. 运行程序

在终端中运行：

```bash
python fund_valuation.py
```

## 📊 运行截图示例

```text
=========== 支付宝基金实时估值助手 (CSV版) ===========
正在读取 funds.csv ...
成功加载 3 只基金。

正在查询数据，请稍候...

代码      基金名称             持有金额     估算涨跌幅     估算盈亏      更新时间
------------------------------------------------------------------------------------------
019172   摩根纳斯达克100...     1968.00     +0.69%       +13.58      14:35:00
024575   嘉实国证自由现金...     4063.00     +1.69%       +68.66      14:35:00
...
------------------------------------------------------------------------------------------
💰 总持有金额: 45881.00
📊 总估算盈亏: +552.16
==========================================================================================

=========== 🧠 AI 智能分析 (基于阿里云百炼) ===========
🤖 正在调用通义千问模型分析当前持仓与市场情绪... (请稍候)
--------------------------------------------------
... (AI 生成的板块分析和操作建议) ...
```

## ⚠️ 免责声明

1.  **数据仅供参考**：本工具显示的估值为盘中实时估算值，数据来源于第三方网络接口，实际净值以基金公司晚间公布为准。
2.  **投资风险**：AI 生成的建议仅基于数据逻辑分析，不构成任何投资承诺或担保。市场有风险，投资需谨慎。
3.  **版权声明**：本项目仅供学习和研究使用，禁止用于商业用途。请遵守相关法律法规。